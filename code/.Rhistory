1+2
setwd("C:/proyectos/FDS/CC216-TP-2023-2-CC51/code")
dataset<-read.csv("../data/hotel_bookings.csv",header=TRUE,sep=",")
head(dataset)
str(dataset)
summary(dataset)
cantidad_duplicadas <- sum(duplicated(dataset))
cat("Cantidad de filas duplicadas:", cantidad_duplicadas, "\n")
dataset <- dataset[!duplicated(dataset), ]
cantidad_duplicadas <- sum(duplicated(dataset))
cat("Cantidad de filas duplicadas:", cantidad_duplicadas, "\n")
sin_valor <- function(x){
sum = 0
for(i in 1:ncol(x))
{
cat("En la columna",colnames(x[i]),"total de valores NA:",colSums(is.na(x[i])),"\n")
}
}
sin_valor(dataset)
en_blanco <- function(x){
sum = 0
for(i in 1:ncol(x))
{
cat("En la columna",colnames(x[i]),"total de valores en blanco:",colSums(x[i]=="NULL"),"\n")
}
}
en_blanco(dataset)
library(dplyr)
library(ggplot2)
library(knitr)
library(dplyr)
freq_table <- dataset %>%
count(hotel)
kable(freq_table)
freq_table %>%
ggplot(aes(x = hotel, y = n)) +
geom_bar(stat = "identity", fill = c("red", "blue")) +
xlab("Tipo de hotel") +
ylab("Número de reservas") +
geom_text(aes(label = n), position = position_stack(vjust = 0.5), colour = "white")
disp_line1<- dataset %>%
filter(arrival_date_year == 2015) %>%
count(arrival_date_month)
disp_line2<- dataset %>%
filter(arrival_date_year == 2016) %>%
count(arrival_date_month)
disp_line3<- dataset %>%
filter(arrival_date_year == 2017) %>%
count(arrival_date_month)
disp_line1$arrival_date_month <- factor(disp_line1$arrival_date_month,levels =c("January","February","March","April","May","June","July","August","September","October","November","December"))
disp_line2$arrival_date_month <- factor(disp_line2$arrival_date_month,levels =c("January","February","March","April","May","June","July","August","September","October","November","December"))
disp_line3$arrival_date_month <- factor(disp_line3$arrival_date_month,levels =c("January","February","March","April","May","June","July","August","September","October","November","December"))
ggplot(data = disp_line1, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")
ggplot(data = disp_line2, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")
ggplot(data = disp_line3, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")
disp_line<- dataset %>%
count(arrival_date_month)
ggplot(data = disp_line, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")
disp_line$arrival_date_month <- factor(disp_line$arrival_date_month,levels =c("January","February","March","April","May","June","July","August","September","October","November","December"))
ggplot(data = disp_line, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")
df_chba <- dataset %>%
select(children, babies)
head(df_chba)
df_chba$has_children_or_babies <- ifelse(df_chba$children > 0 | df_chba$babies > 0, "Yes", "No")
head(df_chba)
View(df_chba)
View(df_chba)
table(df_chba$has_children_or_babies)
parking <- dataset %>%
select(required_car_parking_spaces)
parking$requires_parking <- ifelse(parking$required_car_parking_spaces > 0, "Yes", "No")
table(data$requires_parking)
table(parking$requires_parking)
parkingtable<- parking%>%
count(requires_parking)
print(parkingtable)
print(sum(parkingtable$n))
percentparking<-(parkingtable$n[2]/sum(parkingtable$n))*100
print(percentparking)
print(sum(parkingtable$n))
View(parkingtable)
View(parkingtable)
bookingcanceled %>%
group_by(arrival_date_month) %>%
summarise(n_canceled = sum(is_canceled == "1"))
bookingcanceled<-dataset %>%
group_by(arrival_date_month) %>%
summarise(n_canceled = sum(is_canceled == "1"))
View(bookingcanceled)
View(bookingcanceled)
View(freq_table)
bookingcanceled %>%
ggplot(aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity", fill = c("red", "blue")) +
xlab("Mes") +
ylab("Número de cancelaciones") +
geom_text(aes(label = n), position = position_stack(vjust = 0.5), colour = "white")
bookingcanceled %>%
ggplot(aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity", fill = c("red", "blue")) +
xlab("Mes") +
ylab("Número de cancelaciones")
bookingcanceled %>%
ggplot(aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity") +
xlab("Mes") +
ylab("Número de cancelaciones") +
geom_text(aes(label = n), position = position_stack(vjust = 0.5), colour = "white")
print(bookingcanceled)
ggplot(bookingcanceled, aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")
ggplot(bookingcanceled, aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")
geom_text(aes(label = n), position = position_stack(vjust = 0.5), colour = "white")
ggplot(bookingcanceled, aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")
geom_text(aes(label = n_canceled), position = position_stack(vjust = 0.5), colour = "white")
ggplot(bookingcanceled, aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")+
geom_text(aes(label = n_canceled), position = position_stack(vjust = 0.5), colour = "white")
View(df_chba)
table(df_chba$has_children_or_babies)
print(percentparking)
head(df_chba)
table(df_chba$has_children_or_babies)
df_chba<- df_chba %>%
count(has_children_or_babies)
print(df_chba)
print(df_chba[1])
print(df_chba[2])
print(df_chba[2,1])
print(df_chba[2,])
print(df_chba[3,])
df_chba<-df_chba[-3,]
print(df_chba)
ggplot(df_chba, aes(x = "", fill = has_children_or_babies)) +
geom_pie(stat = "count", size = 2) +
labs(title = "Reservas con niños y/o bebés", x = "", y = "")
print(df_chba)
ggplot(df_chba, aes(x = "", fill = has_children_or_babies)) +
geom_pie(stat = "count", size = 2) +
labs(title = "Reservas con niños y/o bebés", x = "", y = "")
ggplot(df_chba, aes(x = "", fill = has_children_or_babies)) +
geom_bar(stat = "count", size = 2) +
labs(title = "Reservas con niños y/o bebés", x = "", y = "")
ggplot(df_chba, aes(x = "", fill = has_children_or_babies)) +
geom_bar(stat = "count", size = 2) +
labs(title = "Reservas con niños y/o bebés", x = "", y = "")+
coord_polar("y", start=0)
ggplot(df_chba, aes(x = "",y=n,fill = has_children_or_babies)) +
geom_bar(stat = "count", size = 2) +
labs(title = "Reservas con niños y/o bebés", x = "", y = "")+
coord_polar("y", start=0)
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0) + theme_map()
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#999999", "#E69F00"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")
ggplot(data = disp_line1, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
xlab("Mes") +
ylab("Número de reservas")
ggplot(data = disp_line1, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
xlab("Mes") +
ylab("Número de reservas")+
title("aea")
ggplot(data = disp_line1, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")
ggplot(data = disp_line1, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas en el año 2015 seg'un mes", x = "Mes", y = "Número de reservas")
ggplot(data = disp_line1, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas en el año 2015 según mes", x = "Mes", y = "Número de reservas")
print(percentparking)
print(parkingtable)
ggplot(parkingtable, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
expand_limits(x=c(-1,1))
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
expand_limits(x=c(-1,1))
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")+
expand_limits(x=c(-1,1))
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")+
expand_limits(x=c(-1,1))
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
labs(title = "Número de reservas canceladas por mes", x = "Mes", y = "Número de reservas")+
expand_limits(x=c(-1,1))
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
labs(title = "Porcentaje de reservas que solicitaron estacionamiento")+
expand_limits(x=c(-1,1))
freq_table %>%
ggplot(aes(x = hotel, y = n)) +
geom_bar(stat = "identity", fill = c("red", "blue")) +
xlab("Tipo de hotel") +
ylab("Número de reservas") +
geom_text(aes(label = n), position = position_stack(vjust = 0.5), colour = "white")
freq_table %>%
ggplot(aes(x = hotel, y = n)) +
geom_bar(stat = "identity", fill = c("red", "blue")) +
xlab("Tipo de hotel") +
ylab("Número de reservas") +
geom_text(aes(label = n), position = position_stack(vjust = 0.5), colour = "white")+
labs(title = "Cantidad de reservas realizadas segun tipo de hotel")
ggplot(data = disp_line1, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas en el año 2015 según mes", x = "Mes", y = "Número de reservas")
ggplot(data = disp_line2, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas en el año 2016 según mes", x = "Mes", y = "Número de reservas")
ggplot(data = disp_line3, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas en el año 2017 según mes", x = "Mes", y = "Número de reservas")
ggplot(data = disp_line, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")
ggplot(data = disp_line, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")
ggplot(data = disp_line, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas según mes", x = "Mes", y = "Número de reservas")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
labs(title = "Porcentaje de reservas que solicitaron estacionamiento")+
expand_limits(x=c(-1,1))
ggplot(bookingcanceled, aes(x = arrival_date_month, y = n_canceled)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Cantidad de reservas canceladas segun mes", x = "Mes", y = "Número de reservas")+
geom_text(aes(label = n_canceled), position = position_stack(vjust = 0.5), colour = "white")
ggplot(data = disp_line, aes(x = arrival_date_month)) +
geom_histogram(binwidth = 1, fill = "steelblue") +
labs(title = "Reservas realizadas según mes", x = "Mes", y = "Número de reservas")
ggplot(data = disp_line, aes(x = n)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black") +
labs(title = "Distribución de la variable n", x = "Valor de n", y = "Frecuencia")
ggplot(data = disp_line, aes(x = arrival_date_month)) +
geom_histogram(binwidth = 1, fill = "steelblue") +
labs(title = "Distribución de reservas por mes", x = "Mes", y = "Número de reservas")
ggplot(data = disp_line, aes(x = arrival_date_month)) +
geom_bar(stat = "count", fill = "steelblue") +
labs(title = "Distribución de reservas por mes", x = "Mes", y = "Número de reservas")
View(disp_line)
ggplot(data = disp_line, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas según mes", x = "Mes", y = "Número de reservas")
print(disp_line)
ggplot(data = disp_line, aes(x = n)) +
geom_histogram(binwidth = 500, fill = "blue", color = "black") +
labs(title = "Histograma de la variable n", x = "Valor de n", y = "Frecuencia")
ggplot(data = disp_line1, aes(x = n)) +
geom_histogram(binwidth = 500, fill = "blue", color = "black") +
labs(title = "Histograma de la variable n", x = "Valor de n", y = "Frecuencia")
ggplot(data = disp_line, aes(x = arrival_date_month, y = n)) +
geom_point(size = 6,colour="#FFFFFF") +
geom_line(group = 1) +
geom_text(aes(label = n), size = 4,colour="blue")+
labs(title = "Reservas realizadas según mes", x = "Mes", y = "Número de reservas")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#006A66", "#79E57B"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#006A66", "#00026A"))+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#006A66", "#00026A"),name = "Tiene niños y/o bebés")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F16737", "#DC0F06"),name = "Tiene niños y/o bebés")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#DC0F06", "#F16737"),name = "Tiene niños y/o bebés")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"),name = "Requieren estacionamiento")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
labs(title = "Porcentaje de reservas que solicitaron estacionamiento")+
expand_limits(x=c(-1,1))
View(parkingtable)
ggplot(parkingtable, aes(x="", y=n, fill=requires_parking))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#F8FF64", "#79E57B"),labels=c("No","SI"),name = "Requieren estacionamiento")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5))+
labs(title = "Porcentaje de reservas que solicitaron estacionamiento")+
expand_limits(x=c(-1,1))
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#DC0F06", "#F16737"),labels=c("No","SI"),name = "Tiene niños y/o bebés")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#0B1246", "#F49F1C"),labels=c("No","SI"),name = "Tiene niños y/o bebés")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#131D6A", "#DAB200"),labels=c("No","SI"),name = "Tiene niños y/o bebés")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white")+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
ggplot(df_chba, aes(x="", y=n, fill=has_children_or_babies))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
scale_fill_manual(values=c("#131D6A", "#DAB200"),labels=c("No","SI"),name = "Tiene niños y/o bebés")+
geom_text(aes(label=paste0(round(n/sum(n)*100, 2), "%")), position = position_stack(vjust = 0.5),colour="white",size=5)+
labs(title = "Porcentaje de reservas que tienen niños Y/O bebes")
